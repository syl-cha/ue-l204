\documentclass[12pt,a4paper,svgnames]{simplereport}

% Packages
\usepackage{boxes}
\usepackage{minted}
\usepackage{xcolor}
\usepackage{hyperref}
\usepackage{caption}
\usepackage{pdfpages}
\usepackage{setspace}
\captionsetup{
    font={small,it},           % Taille small et italique pour toute la légende
    labelfont={bf,color=black}, % Label en gras et en bleu
    textfont={color=black!60},    % Texte de la légende en noir
    labelsep=endash,           % Séparateur avec tiret cadratin
    format=plain,              % Format simple
    justification=justified,   % Justification du texte
    width=0.8\linewidth        % Largeur à 80% de la ligne (ajustez selon besoin)
}
\geometry{margin=2.5cm}
\graphicspath{{images/}}

% Définition des couleurs
\definecolor{backColor}{RGB}{248,248,248}
\definecolor{subColor}{RGB}{70,130,180}

% Configuration de tcolorbox
\tcbuselibrary{minted,skins,breakable}

% Environnement pour le code JavaScript
\newtcblisting{javascriptcode}{
    listing engine=minted,
    minted style=colorful,
    minted language=javascript,
    minted options={
        fontsize=\small,
        linenos,
        numbersep=3mm,
        firstnumber=1,
        breaklines,breakanywhere,
        breakbytoken
    },
    colback=backColor,
    colframe=subColor,
    listing only,
    left=5mm,
    enhanced,
    sharp corners,
    boxrule=0pt,
    breakable,
    overlay={
        \begin{tcbclipinterior}
            \fill[subColor!30] (frame.south west) rectangle ([xshift=5mm]frame.north west);
        \end{tcbclipinterior}
    }
}

% Configuration des liens
\hypersetup{
    colorlinks=true,
    linkcolor=orange,
    urlcolor=orange,
    citecolor=orange
}


\newcommand{\codetext}[1]{%
\textcolor{Crimson}{\texttt{#1}}
}

\usepackage{titletoc}

% Espacement standard pour les pointillés (ajuste l'espace pour le numéro de page)
\contentsmargin{2.5em} 

% Format pour \part (ex: I, II, III)
% Le texte de la partie (ex: "Introduction") sera en gras
\titlecontents{part}
  [0em]                                      % Indentation à gauche
  {\addvspace{10pt}\bfseries}                % Espace AVANT (réduit) + format texte
  {\textcolor{orange}{\thecontentslabel}\quad} % Format du NUMÉRO (orange + espace)
  {\bfseries}                                  % Format si pas de numéro (gras)
  {\ \titlerule*[.5pc]{.}\ \contentspage}     % Pointillés et page
  [\addvspace{2pt}]                          % Espace APRES (réduit)

% Format pour \section (ex: 1, 2, 3)
% Le texte de la section sera en police normale
\titlecontents{section}
  [1.5em]                                    % Indentation (plus grande que part)
  {\addvspace{2pt}}                         % Espace AVANT (très réduit)
  {\textcolor{orange}{\thecontentslabel}\quad} % Format du NUMÉRO (orange + espace)
  {}                                         % Format si pas de numéro
  {\ \titlerule*[.5pc]{.}\ \contentspage}     % Pointillés et page
  []                                         % Pas d'espace APRES

% Format pour \subsection (ex: 1.1, 1.2)
\titlecontents{subsection}
  [3.0em]                                    % Indentation (plus grande que section)
  {\addvspace{1pt}}                         % Espace AVANT (minimal)
  {\textcolor{orange}{\thecontentslabel}\quad} % Format du NUMÉRO (orange + espace)
  {}                                         % Format si pas de numéro
  {\ \titlerule*[.5pc]{.}\ \contentspage}     % Pointillés et page
  []                                         % Pas d'espace APRES

% Format pour \subsubsection (ex: 1.2.1, 1.2.2)
\titlecontents{subsubsection}
  [4.5em]                                    % Indentation (plus grande que subsection)
  {\addvspace{1pt}}                         % Espace AVANT (minimal)
  {\textcolor{orange}{\thecontentslabel}\quad} % Format du NUMÉRO (orange + espace)
  {}                                         % Format si pas de numéro
  {\ \titlerule*[.5pc]{.}\ \contentspage}     % Pointillés et page
  []                                         % Pas d'espace APRES

  % Titre

\title{UE-L204 MINI-PROJET\\
\vspace*{2cm}
{\titlefont \fontsize{40pt}{36pt}\selectfont Rapport final}\\
\vspace*{2cm}
% \includegraphics[width=0.9\linewidth]{hero_section.png}}
\author{Sylvain Chambon,\\%
Jade Faroux,\\%
Jeanne Salvadori,\\ %
Zoé Van De Moortele}
\date{\today}}
\begin{document}

\maketitle

\clearpage

\tableofcontents

\tcblistof[\section*]{sql}{Tables des requêtes SQL}

\tcblistof[\section*]{php}{Tables des scripts PHP}


\clearpage
\part{Le projet}

\section{Méthodes de travail et outils utilisés}
\begin{itemize}
  \item \textbf{Teams} pour la communication et le partage de fichiers ;
  \item \textbf{GitHub} pour la mise en commun du code sur un \href{https://github.com/syl-cha/ue-l204}{dépôt}
        et pouvoir mieux gérer les modifications via le système de branche ;
  \item Forum de groupe de l'UE : communication et retour sur l'avancement du projet ;
  \item \textbf{Word} pour une rédaction commune et \LaTeX pour la finalisation des rapports ;
  \item un système d'intelligence artificielle générationnelle (\textbf{Gemini}) pour générer les entrées dans les tables.
  \item \textbf{Diagram.net} pour créer un modèle de notre future BDD et visualiser les tables et leurs connexions
  \item \textbf{PhpMyAdmin} pour la création des tables et la génération des entrées dans ces table
  \item \textbf{VS Code} (ou autre éditeurs) : rédaction du code
  \item \textbf{XAMPP} sous Windows ou un stack \textbf{LAMP} sous Linux.
\end{itemize}

\section{Organisation du groupe}

\subsection{Échanges synchrones et asynchrones}

\begin{itemize}
  \item Réunion synchrone par semaine (soit 2 en tout) pour tout le groupe, et autres réunions synchrones pour faire des points d'avancement sur certaines parties du projet, expliquer des changements, etc.
  \item Communication continue tout au long du projet, points d'étapes réguliers entre nous.
\end{itemize}

\subsection{Répartition des tâches}

Afin d’assurer une progression efficace et structurée du projet, les tâches ont été réparties au sein du groupe en fonction des différents domaines à couvrir. Chaque membre a pris en charge une ou plusieurs parties spécifiques du projet, tout en participant activement aux réflexions communes et aux décisions globales. Cette organisation a permis de travailler efficacement tout en garantissant la cohérence et l’évolution continue du projet.

\begin{center}
  \begin{tblr}{width=\linewidth,colspec={X[l,3]X[c,1]},hlines,vlines,stretch=2,%
    row{1}={bg={vert!30},font={\bfseries}}}
    Tâches                                             & Assignation         \\
    Création du Github et de la BDD                    & Sylvain Chambon     \\
    Mise à jour des idées et de l'avancement du projet & Sylvain Chambon     \\
    Mise en forme des rapports sur \LaTeX              & Sylvain Chambon     \\
    Scénario du projet                                 & Zoe Van De Moortele \\
    Gestion de l'admin et des sessions                 & Jeanne Salvadori \\
    Gestion des enseignants                            & Sylvain Chambon     \\
    Gestion des étudiants                              & Zoe Van De Moortele \\
    Mise en forme CSS                                  & Jade Faroux         \\
    Création du support de présentation                & Jade Faroux         \\
    Création du rapport final                          & Jeanne Salvadori    \\
  \end{tblr}
\end{center}

\begin{center}
  \begin{tblr}{width=\linewidth,colspec={X[l,1]},hlines,vlines,stretch=2,%
    row{1}={bg={vert!30},font={\bfseries}}}
    Tâches        communes                                   \\
    Création, reflexion sur le projet et ses fonctionnalités \\
    Amélioration continue, apport d'idées                    \\
    Communication continue                                   \\
  \end{tblr}
\end{center}

\section{Difficultés rencontrées}

\begin{itemize}
  \item Prise en main de la BDD avec PDO : configuration PDO différente selon Windows / Linux, activation des extensions PDO MySQL ou du serveur Apache.\\ \faCheckSquare[regular]\quad \textbf{Résolue}

  \item Problème : les mots de passe fournis dans la BDD ne correspondaient pas au hash réel de "\texttt{123456}". Nous avons fait des tests avec \texttt{password\_hash()} et \texttt{password\_verify()}
        $\longrightarrow$ découverte que le hash était invalide $\longrightarrow$ remplacement des mots de passe hachés directement en BDD.\\ \faCheckSquare[regular]\quad \textbf{Résolue}

  \item Gestion des chemins relatifs entre les pages (\texttt{index.php}, \texttt{pages/accueil.php}, \texttt{pages/deconnexion.php}) : erreurs 404 ou redirections incorrectes à cause de chemins mal construits\\ \faCheckSquare[regular]\quad \textbf{Résolue}
  \item Hashages réalisés par l'IA pour les utilisateurs fictifs se sont avérés faux. NOus avons dû les refaire à l'aide de commande PHP.\\ \faCheckSquare[regular]\quad \textbf{Résolue}


  \item Manque de temps personnel pour cette semaine pour la plupart d'entre nous à causes de raisons personnelles. À adapter en deuxième semaine.
\end{itemize}

\clearpage
\part{Code, techniques\\ et choix de développement}

Depuis le début du projet, nous avons progressivement fait évoluer l’architecture et le code afin de gagner en lisibilité, 
en sécurité et en maintenabilité. Le projet a d’abord été développé avec des fonctionnalités 
essentielles, puis celles-ci ont été progressivement améliorées et complétées au fil du temps.

\section{Étude préliminaire}

\subsection{Scénario}

Créer un site universitaire avec différents niveaux d’accès : étudiant et professeur, éventuellement un administrateur.

Les professeurs peuvent :
\begin{itemize}
  \item Créer, modifier, supprimer des cours.
  \item Voir la liste d’étudiant inscrit.
  \item Gérer les inscriptions (accepter/refuser les étudiants dans leurs cours).
  \item Modifier leur profil (informations personnelles).
\end{itemize}

Les étudiants peuvent :
\begin{itemize}
  \item Consulter l’ensemble des cours disponibles.
  \item Rechercher des cours (nom, professeur, domaine).
  \item S’inscrire à des cours.
  \item Modifier leur profil (informations personnelles).
\end{itemize}

Si assez de temps, mettre en place un système de note (prof donne des notes et les étudiants peuvent y accéder), et d’emploi du temps.

\subsection{Objectifs adaptés à notre scénario}

\subsubsection{Page de connexion}

\begin{itemize}
  \item Formulaire d’entrée où l’utilisateur entre son login et mot de passe.
  \item Système vérifie si cet utilisateur existe dans la BDD.
  \item Le mot de passe doit être crypté.
  \item Si correct, accès au portail étudiant ou professeur.
  \item Si incorrect, message d’erreur.
  \item Changement de mot de passe lors de la première connexion (sécurité).
\end{itemize}

\subsubsection{Page de recherche}

\begin{itemize}
  \item Champ de recherche de cours (par nom, professeur ou domaine).
  \item Doit interroger la BDD avec les critères de recherche.
  \item Afficher les résultats sous forme de tableau, ou message d’erreur si aucun résultat.
\end{itemize}

\subsubsection{Page d’ajout de contenu}

\begin{itemize}
  \item Les professeurs ont une page dédiée pour ajouter, modifier ou supprimer leur cours.
  \item Les professeurs et étudiants peuvent modifier leurs informations personnelles (mail, tel, mot de passe...).
  \item Toutes ces modifications doivent être enregistrées dans la BDD.
\end{itemize}

\subsubsection{Vérification des données}

Avant d’enregistrer quoi que ce soit dans la BDD, tests de sécurité à effectuer systématiquement :
\begin{itemize}
  \item Avant d’enregistrer quoi que ce soit dans la BDD, tests de sécurité à effectuer systématiquement :
  \item Vérifier que les champs obligatoires soient remplis
  \item Les formats des entrées doivent être corrects
  \item Pas de caractères dangereux (balise html)
  \item Messages d’erreur si une de ces vérifications est non conforme
\end{itemize}

\section{Finalisation}

\subsection{Arborescence}

Choix d'une arborescence claire :
\begin{enumerate}
  \item Le dossier \bashcmd{assets} regroupe tout ce qui concerne la mise en forme et les ressources statiques (CSS, images, polices).
  \item Le dossier  \bashcmd{classes} contient les classes PHP, notamment celles dédiées à l’accès à la base de données et à la centralisation des requêtes SQL.
  \item Le dossier \bashcmd{docs} est utilisé pour stocker des documents de travail, notamment des fichiers Markdown servant à noter les idées, les pistes d’amélioration et l’avancement du projet.
  \item Le dossier \bashcmd{pages} est structuré en sous-dossiers afin de séparer la logique applicative (logic) de l’affichage (views). Cette séparation, faite en deuxième semaine, permet de rendre le code plus lisible et plus facile à maintenir.
  \item Au premier niveau du projet, on retrouve les fichiers \bashcmd{index.php}, \bashcmd{config.php}, \bashcmd{functions.php} ainsi que les scripts SQL de la base de données, qui centralisent la configuration, l’initialisation et les fonctions communes utilisées par l’ensemble des pages.
\end{enumerate}
\subsection{Fonctionnalités}

Au fil du développement, plusieurs fonctionnalités majeures ont été implémentées : 
\begin{itemize}
  \item Un système \textbf{d’authentification} permettant de différencier les utilisateurs \textbf{selon leur rôle} (administrateur, enseignant, étudiant). 
  En fonction de ce rôle, l’utilisateur est redirigé vers des pages spécifiques (\bashcmd{admin.php}, \bashcmd{teacher.php} et \bashcmd{student.php}) et n’a accès qu’aux fonctionnalités qui le concernent.
  \item L’\textbf{espace administrateur} permet de gérer les utilisateurs : lister les enseignants et les étudiants, modifier leurs informations, les supprimer, ou encore en ajouter via des formulaires dédiés.
  \item L’\textbf{espace enseignant} propose quant à lui des fonctionnalités liées aux cours, comme la consultation du catalogue, la création de nouveaux cours avec gestion des prérequis, et des actions préparatoires pour l’enseignement ou la suppression de cours.
  \item L’\textbf{espace étudiant} propose des fonctionnalités qui permettent de lister tous les cours de l'université, de pouvoir s'y inscrire et ensuite de pouvoir visualiser ses propres cours. Par contre, certains cours nécessitent des prérequis à l'inscription. Exemple : si on veut s'inscrire à \texttt{INFO-L204}, il faudra avoir suivi le cours \texttt{INFO-L104}.
  \item Un fichier de log \bashcmd{database-errors.log} est également utilisé afin de \textbf{tracer les erreurs} liées à la base de données, ce qui facilite le débogage et l’analyse des problèmes côté serveur.
  
\end{itemize}
\section{Base de données}

Nous avons modélisé notre base de données dans \href{https://app.diagrams.net/}{diagrams.net}.
Nous avons pensé à définir deux utilisateurs pour notre base de données : l'enseignant et l'étudiant.
En structurant notre base, nous nous sommes aperçu que ces deux entités partageaient beaucoup
d'attributs donc nous avons préférer définir l'entité plus générale d'\texttt{utilisateur}
et définir les entités \texttt{enseignant} et \texttt{etudiant} comme des héritages de l'entité
\texttt{utilisateur} avec certains attributs spécifiques.

Dans cette base de données, nous aurons évidemment aussi une entité \texttt{cours}.
\medskip

Nous aurons enfin des tables de liaison :
\begin{itemize}
  \item une table permettant d'associer des enseignants avec des cours (entité \texttt{enseigne}) ;
  \item un autre permettant d'associer des étudiants avec des cours (entité \texttt{etudiant}) ;
  \item une dernière permettant de définir des contraintes sur les inscriptions dans certains cours (entité \texttt{prerequis}).
\end{itemize}

\subsection{Entités}
\subsubsection{Entité \texttt{utilisateur}}
L'entité \texttt{utilisateur} aura les attributs (voir requête \no{\ref{sql:utilisateur}}) :
\begin{itemize}
  \item \texttt{login} : identifiant de connexion ;
  \item \texttt{mot\_de\_passe} : mot de passe pour la connextion :
        il sera encrypté par l'application (ce n'est pas de la responsabilité de la BBD) ;
  \item \texttt{mot\_de\_passe\_provisoire} : booléen servant de drapeau pour savoir si le mot de passe initial a été changé ou pas ;
  \item \texttt{nom}, \texttt{prenom}, \texttt{email} : pour renseigner des élément lié à la personne et son contact ;
  \item \texttt{role} : trois rôles sont défini ici pour pouvoir tester les droits relatifs à chaque utilisateur de la BDD ;
  \item \texttt{date\_creation} pour stocker la date à laquelle l'utilisateur a été saisi dans la BDD ;
  \item \texttt{actif} drapeau pour connaître si la personne est encore en activité dans la faculté.
\end{itemize}

\begin{sql}[title={Création de la table \texttt{utilisateur}},label={sql:utilisateur}]
  CREATE TABLE utilisateur (
  id INT PRIMARY KEY AUTO_INCREMENT,
  login VARCHAR(255) UNIQUE NOT NULL,
  mot_de_passe VARCHAR(255) NOT NULL,
  mot_de_passe_provisoire BOOLEAN DEFAULT TRUE,
  nom VARCHAR(100) NOT NULL,
  prenom VARCHAR(100) NOT NULL,
  email VARCHAR(255) UNIQUE NOT NULL,
  role ENUM('enseignant', 'etudiant', 'admin') NOT NULL,
  date_creation TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  actif BOOLEAN DEFAULT TRUE
  );
\end{sql}

On se rend compte que tous ces attributs serons partagés à la fois par les enseignants et par les étudiants.

Un ajout d'un utilisateur dans la BDD peut donc se déclarer ainsi (voir exemple de requête \no{\ref{sql:utilisateur:creation}})

\begin{sql}[title={Création d'un utilisateur dans la table},label={sql:utilisateur:creation}]
  (1, 'turing', '<mot-de-passe>', 'Turing', 'Alan', 'alan.turing@univ.fr', 'enseignant'),
\end{sql}

\subsubsection{Entité \texttt{enseignant}}

L'entité \texttt{enseignant} hérite de de l'entité \texttt{utilisateur} avec quelques spécificités :
\begin{itemize}
  \item \texttt{bureau} : localisation de la salle de travail de l'enseignant ;
  \item \texttt{telephone} : numéro ;
  \item \texttt{specialite} : domaine d'expertise ;
  \item \texttt{statut} : sous quel titre l'enseignant a-t-il été embauché.
\end{itemize}

On constate la présence d'une clé étrangère afin de lier l'entité \texttt{enseignant}
avec une entité \texttt{utilisateur} existante (héritage).

\begin{sql}[title={Création de la table \texttt{enseignant}},label={sql:enseignant}]
  CREATE TABLE enseignant (
  id INT PRIMARY KEY AUTO_INCREMENT,
  utilisateur_id INT UNIQUE NOT NULL,
  bureau VARCHAR(50),
  telephone VARCHAR(20),
  specialite VARCHAR(255),
  statut ENUM('titulaire', 'vacataire', 'contractuel') DEFAULT 'titulaire',
  FOREIGN KEY (utilisateur_id) REFERENCES utilisateur(id) ON DELETE CASCADE
  );
\end{sql}

On ajoutera un enseignant ainsi dans la base (voir exemple de requête \no{\ref{sql:enseignant:creation}})

\begin{sql}[title={Création d'un enseignant dans la table},label={sql:enseignant:creation}]
  INSERT INTO enseignant (utilisateur_id, bureau, telephone, specialite, statut) VALUES
  (1, 'B101', '0102030401', 'Intelligence Artificielle', 'titulaire');
\end{sql}



\subsubsection{Entité \texttt{etudiant}}

L'entité \texttt{etudiant} hérite de de l'entité \texttt{utilisateur} avec quelques spécificités :
\begin{itemize}
  \item le classique \texttt{numero\_etudiant}, comme référence nationale ;
  \item \texttt{niveau} qui référence si l'étudiant est en licence ou master et en quelle année ;
  \item \texttt{date\_inscription} qui peut-être de la \texttt{date\_creation} si l'étudiant n'a pas validé ses frais de scolarité par exemple.
\end{itemize}
On constate ici aussi la présence d'une clé étrangère afin de lier l'entité \texttt{étudiant}
avec une entité \texttt{utilisateur} existante (héritage, comme pour l'entité \texttt{enseignant}).

\begin{sql}[title={Création de la table \texttt{etudiant}},label={sql:etudiant}]
  CREATE TABLE etudiant (
  id INT PRIMARY KEY AUTO_INCREMENT,
  utilisateur_id INT UNIQUE NOT NULL,
  numero_etudiant VARCHAR(20) UNIQUE NOT NULL,
  niveau ENUM('L1', 'L2', 'L3', 'M1', 'M2') NOT NULL,
  date_inscription DATE NOT NULL,
  FOREIGN KEY (utilisateur_id) REFERENCES utilisateur(id) ON DELETE CASCADE
  );
\end{sql}

Pour ajouter un étudiant dans la base, on pourra procéder ainsi (voir exemple de requête \no{\ref{sql:etudiant:creation}})

\begin{sql}[title={Création d'un étudiant dans la table},label={sql:etudiant:creation}]
  INSERT INTO etudiant (utilisateur_id, numero_etudiant, niveau, date_inscription) VALUES
  (12, '20250001', 'L3', '2024-09-01');
\end{sql}

\subsubsection{Entité \texttt{cours}}

L'entité \texttt{cours} a les attributs suivants :
\begin{itemize}
  \item \texttt{code} joue le rôle d'identifiant visuel et sera pratique pour les recherches ;
  \item \texttt{nom} intitulé du cours ;
  \item \texttt{credits} pour garder le nombre de crédits ECTS ;
  \item \texttt{description} pour donner le détail sdu contenu du cours ou un syllabus ;
  \item \texttt{capacite\_max} pour gérer le nombre d'étudiants qui peuvent s'inscrire ;
  \item \texttt{annee\_universitaire} indique quand le cours est proposé ;
  \item \texttt{actif} en un drapeau booléen permettant de savoir si le cours est proposé en enseignement ou pas.
\end{itemize}

\begin{sql}[title={Création de la table \texttt{cours}},label={sql:cours}]
  CREATE TABLE cours (
  id INT PRIMARY KEY AUTO_INCREMENT,
  code VARCHAR(20) UNIQUE NOT NULL,
  nom VARCHAR(255) NOT NULL,
  credits INT NOT NULL CHECK (credits > 0),
  description TEXT,
  capacite_max INT DEFAULT 30,
  annee_universitaire VARCHAR(9) NOT NULL,  -- "2025-2026"
  actif BOOLEAN DEFAULT TRUE
  );
\end{sql}

La création d'un cours peut s'effectuer à l'aide de la requête suivante :
\begin{sql}[title={Création d'un cours dans la table},label={sql:cours:creation}]
  INSERT INTO cours (code, nom, credits, description, annee_universitaire) VALUES
  ('INFO-L101', 'Introduction à l''Algorithmique', 6, 'Logique, pseudo-code, variables et boucles', '2025-2026');
\end{sql}

\subsection{Tables de liaison}

À ce stade, nous n'avons généré dans la base qu'une seule table de liaison : celles concernant les prérequis.

Pour les autres tables de liaison (\texttt{enseigne} et \texttt{inscription}),
nous pensons qu'il faudra plutôt les faire depuis l'interface.

Un prérequis pour un cours fonctionne ainsi : on réunit deux ID de cours, la première référençant un Cours A,
la deuxièmes référençant un Cours B nécessaire pour suivre le Cours A. Ainsi, cette relation est bien une relation \textit{many-to-many} :
\begin{itemize}
  \item le Cours A ayant besoin de plusieurs cours pour être suivi ;
  \item le Cours A pouvant être nécessaire à d'autres cours.
\end{itemize}

Voici comment nous avons donc défini cette table :

\begin{sql}[title={Table de liaison \texttt{prerequis}},label={sql:prerequis}]
  CREATE TABLE prerequis (
  cours_id INT NOT NULL,
  prerequis_cours_id INT NOT NULL,
  PRIMARY KEY (cours_id, prerequis_cours_id),
  FOREIGN KEY (cours_id) REFERENCES cours(id) ON DELETE CASCADE,
  FOREIGN KEY (prerequis_cours_id) REFERENCES cours(id) ON DELETE CASCADE,
  CHECK (cours_id != prerequis_cours_id)
  );
\end{sql}

La dernière ligne \no{7} permet d'interdire un auto-référencement.
\medskip

Pour déclarer une telle relation, nous pouvons faire (voir exemple de requête ci-dessous \no{\ref{sql:prerequis:creation}}) :
\begin{sql}[title={Création d'une relation de prérequis},label={sql:prerequis:creation}]
  INSERT INTO prerequis (cours_id, prerequis_cours_id) VALUES
  ((SELECT id FROM cours WHERE code='INFO-L201'), (SELECT id FROM cours WHERE code='INFO-L101'));
\end{sql}

On remarque que plutôt que d'utiliser directement les ID des cours, on utilise l'attribut \texttt{code}
sur une condition dans une clause qui va nous permettre de retrouver l'ID du cours. Cette méthode est plus robuste car
si l'ID d'un cours venait à changer alors on ne perdrait pas la relation de prérequis.

\subsection{Cohérences des données}

La base de données a été pensée de manière relationnelle, avec une table centrale utilisateur 
et des tables spécifiques pour les enseignants, les étudiants et les cours
avec des systèmes de vérifications propres à une base de données (identifiants unique, repérage des doublons, etc.).

Les opérations sensibles (ajout d’un enseignant ou d’un étudiant) sont réalisées à l’aide de transactions 
afin de garantir la cohérence des données. C'est la base de données seule qui est responsable de cette cohérence 
et non le code PHP qui ne fait qu'interpréter les erreurs renvoyées et agir en conséquence. 
En cas d’erreur, les modifications sont annulées 
et l’erreur est enregistrée dans les logs.

L’utilisation de clés étrangères permet également de gérer automatiquement certaines suppressions grâce aux mécanismes de cascade.

\includepdf[pages={1},angle=90]{UE_L204_mini-Projet_DB.pdf}

\input{partCode}

\clearpage
\part{Prolongements}

Il existe bien évidemment une foules de possibilités à partir d'une base de données comme celle-ci.

Dans l'immédiat, nous aurions voulu avoir le temps d'implémenter ces fonctionnalités :

\begin{itemize}
  \item Mécanisme de gestion de durée de connexion.
  \item Vérification sur les champs des formulaires (à perfectionner).
  \item Gestion des mots de passe provisoires (un attribut dans l'entité \texttt{utilisateur} a été prévu à cet égard).
  \item Les demandes d'inscription (des élèves) et de création de cours (des enseignants) devraient rester en attente de validation de l'admin.
  \item Gestion des notes.
  \item Possibilité pour les utilisateurs de changer des données personnelles.
  \item Système de contrôle des spécialités dans la création d'un cours (nécessiterait une table particulière et la table de liaison afférente).
  \item Gestion de la responsabilité d'un cours (délégation de la validation de l'inscription d'un étudiant d'un cours à l'enseignant responsable -- flag prévu dans l'entité \texttt{cours}).
  \item Possibilité de lister les enseignants animant un cours.
\end{itemize}

\clearpage
\part{Annexe :\\ génération de la base de données}

La base utilisée par l'application porte le nom de \texttt{universite1}.
Afin d'initialiser cette base de données pour cette application,
de créer les entités nécessaires et de les alimenter de quelques entrées,
il convient d'exécuter les scripts suivants (présents dans l'archive du projet) \textbf{en respectant l'ordre} !

\begin{enumerate}
  \item \bashcmd{universiteDB\_access.sql}
  \item \bashcmd{universiteDB\_tables.sql}
  \item \bashcmd{universiteDB\_populate.sql}
\end{enumerate}

L'utilisateur administrateur de l'application est \texttt{admin}. 
Il pourra lister les autres utilisateurs pour faire  éventuellement des tests avec différents rôles.

Tous les mots de passe sont \texttt{123456} par défaut, y compris lors de création de nouvel utilisateur dans la base.
\end{document}